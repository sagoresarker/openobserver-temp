# Dev image: install deps once (cached), then run dev server.
# Use volumes so code changes don't require rebuild. Rebuild only when package*.json changes.
FROM node:20-alpine

WORKDIR /app

# Copy dependency manifests first - this layer caches when only source changes
COPY package.json package-lock.json* ./
RUN npm install --legacy-peer-deps --no-audit

# Rest of app (overridden by volume when using docker-compose)
COPY . .

EXPOSE 8081
CMD ["npm", "run", "dev", "--", "--host", "0.0.0.0", "--port", "8081"]
